# new_project - Анализ глобальных выбросов CO₂
Проект по анализу и визуализации данных о глобальных выбросах углекислого газа.
Ссылка на Data: https://disk.yandex.ru/d/iJy44WhoHY-y0w

Данный датасет содержит структурированную информацию о глобальных выбросах CO₂. Он состоит из 50 столбцов, некоторые из которых посвящены определению стран и регионов, другие - значениям выбросов по различным категориям, а также дополнительным столбцам для подробной классификации. Набор данных позволяет проводить всесторонний анализ выбросов с географической, экономической и отраслевой точек зрения, что делает его ценным для исследований, оценки политики и глобальных сравнений.

# Структура проекта
├── api_example/              # Примеры работы с API

│   └── notebook/             # Jupyter-ноутбуки

├── parse_example/            # Пример парсинга данных

├── notebooks/

│   └── EDA.ipynb            # Ноутбук с исследовательским анализом данных

│   └── Notebook.ipynb       # Ноутбук с доказательством того, что типы верные

├── .gitignore               # Игнорируемые файлы Git

├── README.md                # Этот файл

├── data_loader.py           # Скрипт загрузки и обработки данных

├── environment.yml          # Конфигурация окружения Conda

└── write_to_db.py           # Скрипт записи в базу данных

# Установка и настройка окружения
Инструкция по созданию окружения conda из файла environment.yml
1. Установить conda.
2. Написать команду ```conda env create -f environment.yml``` в терминал.
3. Активировать окружение ```conda activate your-environment-name```

# Запуск скрипта
Используйте команду ```python data_loader.py```, чтобы посмотреть на вывод скрипта.

На рисунке ниже представлен результат работы скрипта `data_loader.py`

<img width="1026" height="519" alt="image" src="https://github.com/user-attachments/assets/62c12512-452b-41c7-b7a0-86a919d5e79b" />

Метод ```convert_dtypes()``` используется для преобразования столбцов DataFrame в наиболее подходящий тип данных, поддерживающий pd.NA для отсутствующих значений. Так как в Data 80 колонок, этот метод лучше всего подходит для преобразования типов DataFrame.

Здесь «наилучший из возможных» означает тип, наиболее подходящий для хранения значений. Например, это целочисленный тип pandas, если все значения являются целыми числами (или отсутствуют): столбец объектов Python, содержащих целые числа, преобразуется в Int64, а столбец значений NumPy int32 становится типом pandas Int32.

# Запись данных в базу данных

Используте ```python write_to_db.py``` для запуска скрипта. Что он делает: выполняет запись данных в SQLite базу данных.

Что делает скрипт:
1. Подключается к PostgreSQL - использует учетные данные из creds.db
2. Создает таблицу `kalaturskaya` в схеме `public` базы homeworks
3. Загружает данные - читает первые 100 строк из data.parquet
4. Записывает в БД - использует метод `to_sql` с заменой существующих данных
5. Проверяет результат - выводит количество записанных строк

